<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard DHT11 - Monitoring IoT</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="/" class="logo">ğŸŒ¡ï¸ DHT11 Monitor</a>
            <ul class="nav-links">
                <li><a href="/">Dashboard</a></li>
                <li><a href="/myChart/">Graphiques</a></li>
                <li><a href="/index/">Valeurs</a></li>
                <li><a href="/api/">API</a></li>
                <li><a href="/download_csv/">Export CSV</a></li>
                <li><a href="/admin/">Admin</a></li>
                <li>
                    <button id="theme-toggle" class="theme-toggle-btn" onclick="toggleTheme()">
                        ğŸŒ™ Mode Sombre
                    </button>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <!-- Header -->
        <header>
            <h1>ğŸ“Š Dashboard IoT - Monitoring DHT11</h1>
            <p class="subtitle">Surveillance en temps rÃ©el de la tempÃ©rature et de l'humiditÃ©</p>
        </header>

        <!-- Live Measurements -->
        <div class="live-section">
            <h2 class="live-title">âš¡ Mesures en Direct</h2>
            <div class="live-grid">
                <div class="live-card">
                    <div class="live-icon">ğŸŒ¡ï¸</div>
                    <div class="live-value" id="current-temp">--</div>
                    <div class="live-label">TempÃ©rature (Â°C)</div>
                    <div class="live-time-info" id="last-update">Chargement...</div>
                    <a href="/graph_temp/" class="btn-graph-small">ğŸ“ˆ Voir Graphique</a>
                </div>

                <div class="live-card">
                    <div class="live-icon">ğŸ’§</div>
                    <div class="live-value" id="current-hum">--</div>
                    <div class="live-label">HumiditÃ© (%)</div>
                    <div class="live-time-info" id="hum-time">Chargement...</div>
                    <a href="/graph_hum/" class="btn-graph-small">ğŸ“ˆ Voir Graphique</a>
                </div>
            </div>
        </div>

        <!-- Manual Data Entry Section -->
        <div class="manual-entry-section">
            <h2 class="live-title">âœï¸ EntrÃ©e Manuelle de DonnÃ©es</h2>
            <div class="manual-entry-card">
                <div class="input-group">
                    <label for="manual-temp">ğŸŒ¡ï¸ TempÃ©rature (Â°C):</label>
                    <input type="number" id="manual-temp" step="0.1" placeholder="Ex: 25.5">
                </div>
                <div class="input-group">
                    <label for="manual-hum">ğŸ’§ HumiditÃ© (%):</label>
                    <input type="number" id="manual-hum" step="0.1" placeholder="Ex: 60.0">
                </div>
                <button onclick="submitManualData()" class="btn-submit-manual">
                    ğŸ“¤ Envoyer les DonnÃ©es
                </button>
                <div id="manual-entry-message" class="manual-entry-message"></div>
            </div>
        </div>

        <!-- Section Incidents -->
        <div class="incident-section">
            <h2 class="live-title">ğŸš¨ Gestion des Incidents</h2>

            <div id="incident-status" class="incident-status-ok">
                âœ… Pas d'incidents
            </div>

            <div id="incident-details" class="incident-details-hidden">
                <div class="incident-counter-box">
                    <p class="incident-counter-text">
                        <strong>Compteur d'incidents:</strong>
                        <span id="incident-compteur" class="incident-compteur-value">0</span>
                    </p>
                    <p class="incident-date-info">
                        <strong>Date de dÃ©but:</strong>
                        <span id="incident-date-debut">--</span>
                    </p>
                </div>

                <!-- OpÃ©ration 1 -->
                <div id="op1-container" class="operation-container op1-hidden">
                    <div class="operation-header">
                        <input type="checkbox" id="op1-check" class="operation-checkbox">
                        <label for="op1-check" class="operation-label" id="op1-label">âœ“ OpÃ©ration Corrective 1</label>
                    </div>
                    <textarea id="op1-comment" placeholder="Commentaires (facultatif)..." class="operation-textarea" rows="3"></textarea>
                    <button id="op1-btn" class="btn-validate-op" onclick="saveOperation(1)">
                        âœ“ Valider OpÃ©ration 1
                    </button>
                </div>

                <!-- OpÃ©ration 2 -->
                <div id="op2-container" class="operation-container op2-hidden">
                    <div class="operation-header">
                        <input type="checkbox" id="op2-check" class="operation-checkbox">
                        <label for="op2-check" class="operation-label" id="op2-label">âœ“ OpÃ©ration Corrective 2</label>
                    </div>
                    <textarea id="op2-comment" placeholder="Commentaires (facultatif)..." class="operation-textarea" rows="3"></textarea>
                    <button id="op2-btn" class="btn-validate-op" onclick="saveOperation(2)">
                        âœ“ Valider OpÃ©ration 2
                    </button>
                </div>

                <!-- OpÃ©ration 3 -->
                <div id="op3-container" class="operation-container op3-hidden">
                    <div class="operation-header">
                        <input type="checkbox" id="op3-check" class="operation-checkbox">
                        <label for="op3-check" class="operation-label" id="op3-label">âœ“ OpÃ©ration Corrective 3</label>
                    </div>
                    <textarea id="op3-comment" placeholder="Commentaires (facultatif)..." class="operation-textarea" rows="3"></textarea>
                    <button id="op3-btn" class="btn-validate-op" onclick="saveOperation(3)">
                        âœ“ Valider OpÃ©ration 3
                    </button>
                </div>
            </div>

            <div style="margin-top: 20px;">
                <a href="/archive-incidents/" class="btn-archive" style="display: block; margin-bottom: 10px;">
                    ğŸ“‚ Voir Archive des Incidents
                </a>
                <a href="/download_incidents_excel/" class="btn-archive" style="display: block;">
                    ğŸ“Š Exporter Incidents vers Excel
                </a>
            </div>
        </div>

        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-value" id="total-records">0</div>
                <div class="stat-label">Total Enregistrements</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ğŸŒ¡ï¸</div>
                <div class="stat-value" id="avg-temp">--</div>
                <div class="stat-label">TempÃ©rature Moyenne</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ğŸ’§</div>
                <div class="stat-value" id="avg-hum">--</div>
                <div class="stat-label">HumiditÃ© Moyenne</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ğŸ”„</div>
                <div class="stat-value" id="status" class="status-offline">â— Attente...</div>
                <div class="stat-label">Ã‰tat du SystÃ¨me</div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="actions">
            <a href="/myChart/" class="btn-secondary">ğŸ“ˆ Voir Graphiques</a>
            <a href="/api/" class="btn-secondary" target="_blank">ğŸ”— API ComplÃ¨te</a>
            <a href="/download_csv/" class="btn-secondary">ğŸ’¾ TÃ©lÃ©charger CSV</a>
            <a href="/admin/" class="btn-secondary" target="_blank">âš™ï¸ Administration</a>
        </div>

        <!-- Footer -->
        <footer>
            <p id="status-message" style="color: #888;">SystÃ¨me de monitoring DHT11 en ligne</p>
        </footer>
    </div>

    <script src="/static/js/dashboard.js"></script>
</body>
</html>