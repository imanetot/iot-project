<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard IoT - DHT11</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="/" class="logo">ğŸŒ¡ï¸ DHT11 Monitor</a>
            <ul class="nav-links">
                <li><a href="/">Dashboard</a></li>
                <li><a href="/graph_temp/">Graphique Temp</a></li>
                <li><a href="/graph_hum/">Graphique Hum</a></li>
                <li><a href="/api/">API DonnÃ©es</a></li>
                <li><a href="/download_csv/">Export CSV</a></li>
                <li><a href="/admin/">Admin</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <!-- Header -->
        <header>
            <h1>ğŸ“Š Dashboard IoT - Monitoring DHT11</h1>
            <p class="subtitle">Surveillance en temps rÃ©el de la tempÃ©rature et de l'humiditÃ©</p>
        </header>

        <!-- Live Measurements -->
        <div class="live-section">
            <h2 class="live-title">âš¡ Mesures en Direct</h2>
            <div class="live-grid">
                <div class="live-card">
                    <div class="live-icon">ğŸŒ¡ï¸</div>
                    <div class="live-value" id="tempValue">--</div>
                    <div class="live-label">TempÃ©rature</div>
                    <div class="live-time-info" id="tempTime">Chargement...</div>
                    <a href="/graph_temp/" class="btn-graph-small">ğŸ“ˆ Voir Graphique</a>
                </div>

                <div class="live-card">
                    <div class="live-icon">ğŸ’§</div>
                    <div class="live-value" id="humValue">--</div>
                    <div class="live-label">HumiditÃ©</div>
                    <div class="live-time-info" id="humTime">Chargement...</div>
                    <a href="/graph_hum/" class="btn-graph-small">ğŸ“ˆ Voir Graphique</a>
                </div>

                <div class="live-card">
                    <div class="live-icon">ğŸ•</div>
                    <div class="live-value" id="live-time">--:--</div>
                    <div class="live-label">Heure Actuelle</div>
                </div>
            </div>
        </div>

        <!-- Section Incidents -->
        <div class="incident-section">
            <h2 class="live-title">ğŸš¨ Gestion des Incidents</h2>

            <div id="incident-status" class="incident-status-ok">
                âœ… Pas d'incidents
            </div>

            <div id="incident-details" class="incident-details-hidden">
                <div class="incident-counter-box">
                    <p class="incident-counter-text">
                        <strong>Compteur d'incidents:</strong>
                        <span id="incident-compteur" class="incident-compteur-value">0</span>
                    </p>
                </div>

                <!-- OpÃ©ration 1 -->
                <div id="op1-container" class="operation-container op1-hidden">
                    <div class="operation-header">
                        <input type="checkbox" id="op1-check" class="operation-checkbox">
                        <label for="op1-check" class="operation-label">OpÃ©ration Corrective 1 (Compteur â‰¥ 1)</label>
                    </div>
                    <textarea id="op1-comment" placeholder="Commentaires (facultatif)..." class="operation-textarea"></textarea>
                </div>

                <!-- OpÃ©ration 2 -->
                <div id="op2-container" class="operation-container op2-hidden">
                    <div class="operation-header">
                        <input type="checkbox" id="op2-check" class="operation-checkbox">
                        <label for="op2-check" class="operation-label">OpÃ©ration Corrective 2 (Compteur â‰¥ 4)</label>
                    </div>
                    <textarea id="op2-comment" placeholder="Commentaires (facultatif)..." class="operation-textarea"></textarea>
                </div>

                <!-- OpÃ©ration 3 -->
                <div id="op3-container" class="operation-container op3-hidden">
                    <div class="operation-header">
                        <input type="checkbox" id="op3-check" class="operation-checkbox">
                        <label for="op3-check" class="operation-label">OpÃ©ration Corrective 3 (Compteur â‰¥ 7)</label>
                    </div>
                    <textarea id="op3-comment" placeholder="Commentaires (facultatif)..." class="operation-textarea"></textarea>
                </div>

                <button onclick="saveIncident()" class="btn-save-incident">
                    ğŸ’¾ Enregistrer les OpÃ©rations
                </button>
            </div>

            <div class="archive-link-container">
                <a href="/archive-incidents/" class="btn-archive">
                    ğŸ“‚ Voir Archive des Incidents
                </a>
            </div>
        </div>

        <!-- Chart Filters -->
        <div class="filter-buttons">
            <button class="btn active" onclick="loadChartData('all')">Toutes les donnÃ©es</button>
            <button class="btn" onclick="loadChartData('jour')">24 heures</button>
            <button class="btn" onclick="loadChartData('semaine')">7 jours</button>
            <button class="btn" onclick="loadChartData('mois')">30 jours</button>
        </div>

        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-value" id="total-records">0</div>
                <div class="stat-label">Total Enregistrements</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ğŸŒ¡ï¸</div>
                <div class="stat-value" id="avg-temp">--</div>
                <div class="stat-label">TempÃ©rature Moyenne</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ğŸ’§</div>
                <div class="stat-value" id="avg-hum">--</div>
                <div class="stat-label">HumiditÃ© Moyenne</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">ğŸ”„</div>
                <div class="stat-value" id="status-indicator">ğŸŸ¢</div>
                <div class="stat-label">Ã‰tat du SystÃ¨me</div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="actions">
            <a href="/api/" class="btn-secondary" target="_blank">ğŸ”— API ComplÃ¨te</a>
            <a href="/download_csv/" class="btn-secondary">ğŸ’¾ TÃ©lÃ©charger CSV</a>
            <a href="/admin/" class="btn-secondary" target="_blank">âš™ï¸ Administration</a>
        </div>

        <!-- Footer -->
        <footer>
            <p id="status" class="status-offline">â— En attente de connexion...</p>
        </footer>
    </div>

    <script src="/static/js/dashboard.js"></script>
</body>
</html>